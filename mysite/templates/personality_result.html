{% extends 'layout.html' %}
{% block radar_chart %}

<div class="row">
  <div class= "twelve columns offset-by-eleven">
<a href="https://twitter.com/share?url=https://wwww.khaleesicode.com?call_id={{call_id}}" class="twitter-share-button" data-text="Check out my personality insights" data-via="SuperMaryCherry" data-hashtags="khaleesicode" data-show-count="false" >Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>
</div>

  <div class="row">
    <div class="twelve columns">
        <a href="https://www.ibm.com/watson/developercloud/doc/personality-insights/models.html#outputNeeds" target="_blank"><h3 style="text-align: center;">Needs</h3></a>
        <div class="row">
          <div class="six columns offset-by-three">
			      <canvas id="needs"></canvas>
        </div>
    </div>
	</div>
</div>
  <div class="row">
    <div class="twelve columns">
    <a href="https://www.ibm.com/watson/developercloud/doc/personality-insights/models.html#outputValues" target="_blank">  <h3 style="text-align: center;">Values</h3></a>
    <div class="row">
      <div class="six columns offset-by-three">
      <canvas id="values" ></canvas>
    </div>
  </div>
</div>
</div>
  <div class="row">
    <div class="twelve columns">
      <a href="https://www.ibm.com/watson/developercloud/doc/personality-insights/models.html#outputBigFive" target="_blank"><h3 style="text-align: center;">Personality</h3></a>
      <div class="row">
        <div class="six columns offset-by-three">
      <canvas id="personality" ></canvas>
    </div>
    </div>
  </div>
</div>


<script>
//options for all charts

  var charts = Object.keys({{insights|tojson}});

	for (i=0; i< charts.length; i++){

    //create a context for given category and element
		var ctx = document.getElementById(charts[i])
    var chart_name = charts[i];
    var insights = {{insights|tojson}};
    var chart_obj = insights[chart_name];
    //create labels array
    var labels = [];
    for (k=0; k< chart_obj.labels.length; k++){
      var l = chart_obj.labels[k];
      labels.push(l);
    }
    //create raw scores array
    var raw_scores = [];
    for (j=0; j< chart_obj.raw_scores.length; j++){
      var s = chart_obj.raw_scores[j];
      raw_scores.push(s);
    }
    //create percentiles array
    var percentiles = [];
    for (z=0; z< chart_obj.percentiles.length; z++){
      var p = chart_obj.percentiles[z];
      percentiles.push(p);
    }
    var data = {
    	//passin labels as label object from views
    	labels: labels,
    	datasets:[{
    		label:"Raw Score",
    		data: raw_scores,
    		fill:true,
    		backgroundColor:"rgba(255, 99, 132, 0.2)",
    		borderColor:"rgb(255, 99, 132)",
    		pointBackgroundColor:"rgb(255, 99, 132)",
    		pointBorderColor:"#fff",
    		pointHoverBackgroundColor:"#fff",
    		pointHoverBorderColor:"rgb(255, 99, 132)"},
    		{
    			label:"Percentile",
    			data:percentiles,
    			fill:true,
    			backgroundColor:"rgba(54, 162, 235, 0.2)",
    			borderColor:"rgb(54, 162, 235)",
    			pointBackgroundColor:"rgb(54, 162, 235)",
    			pointBorderColor:"#fff",
    			pointHoverBackgroundColor:"#fff",
    			pointHoverBorderColor:"rgb(54, 162, 235)"}
    		]
    	};
    console.log("Data variable: ", data);

    var options = {
      	elements:{
      		line:{
      			tension:0,
      			borderWidth:3
      		}
      	}
      };

  var chart = new Chart(ctx, {
      type:"radar",
      data: data,
      options: options
      });
  }


</script>

{% endblock %}
